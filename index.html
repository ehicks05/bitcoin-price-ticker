<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css" />
</head>
<body>

<section class="section">
    <div class="container">
        <div class="title is-1" id="price"></div>
        <div class="subtitle is-3" id="time"></div>
    </div>
</section>


<script>
    var subscribeMessage = {
        "type": "subscribe",
        "product_ids": [
            "BTC-USD"
        ],
        "channels": [
            "ticker"
        ]
    };

    var exampleSocket = new WebSocket("wss://ws-feed.pro.coinbase.com");

    exampleSocket.onopen = function (event) {
        exampleSocket.send(JSON.stringify(subscribeMessage));
    };

    exampleSocket.onmessage = function (event) {
        console.log(event.data);
        var response = JSON.parse(event.data);

        var time = response.time;
        var timeString = new Date(time).toLocaleTimeString();

        var price = response.price;
        price = "$" + Number.parseFloat(price).toFixed(2);

        document.getElementById("time").innerText = timeString;
        document.getElementById("price").innerText = price;
    };

</script>

</body>
</html>